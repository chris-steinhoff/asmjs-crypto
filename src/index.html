<!DOCTYPE html>
<html>
<head>
	<title></title>
	<meta charset="UTF-8">
	<link type="text/css" rel="stylesheet" href="asmjs.css"/>
	<script type="text/javascript" src="common.js"></script>
	<script type="text/javascript" src="hex.js" defer="defer"></script>
	<script type="text/javascript" src="aes.js" defer="defer"></script>
	<script type="text/javascript">

		/**
		 * @param {string} str
		 * @returns {string}
		 */
		function escapeHtml(str) {
			return str.replace(escapeHtml.amp, "&amp;").replace(escapeHtml.lt, "&lt;");
		}
		escapeHtml.lt = /[<]/g;
		escapeHtml.amp = /[&]/g;
		
		window.addEventListener("load", function() {

			var hex_form = document.getElementById("hex_form");
			var hex_plaintext = document.getElementById("hex_plaintext");
			var hex_submit = document.getElementById("hex_submit");
			var hex_output = document.getElementById("hex_output");
			var hex_plain_output = document.getElementById("hex_plain_output");

			hex_form.onsubmit = function(event) {
				event.preventDefault();

				var buff = CS.stringToArrayBuffer(hex_plaintext.value);
				console.time("toHex");
				var hex = Hex.toHex(buff);
				console.timeEnd("toHex");
				hex_output.innerHTML = hex;

				console.time("fromHex");
				buff = Hex.fromHex(hex);
				console.timeEnd("fromHex");
				hex = CS.arrayBufferToString(buff);
				hex_plain_output.innerHTML = escapeHtml(hex);
			};

			var aes_form = document.getElementById("aes_form");
			var aes_password = document.getElementById("aes_password");
			var aes_plaintext = document.getElementById("aes_plaintext");
			var aes_submit = document.getElementById("aes_submit");
			var aes_output = document.getElementById("aes_output");
			var aes_plain_output = document.getElementById("aes_plain_output");

			aes_form.onsubmit = function(event) {
				event.preventDefault();
				console.time("aes");
				Aes.encrypt(aes_password.value, aes_plaintext.value);
				console.timeEnd("aes");
			};

		});
	</script>
</head>
<body>

<div class="module">
	<div class="module_header">Hex</div>
	<form id="hex_form" class="module_form">
		<label for="hex_plaintext" class="module_label">Text:</label>
		<textarea id="hex_plaintext" class="module_text">a</textarea><br/>
		<button id="hex_submit" type="submit" class="module_submit">Submit</button>
	</form>
	<div class="module_result">
		<span id="hex_output" class="output"></span><br/>
		<span id="hex_plain_output" class="output"></span>
	</div>
</div>

<div class="module">
	<div class="module_header">AES</div>
	<form id="aes_form" class="module_form">
		<label for="aes_password" class="module_label">Password:</label>
		<input id="aes_password" type="text" class="module_text"/><br/>
		<label for="aes_plaintext" class="module_label">Text:</label>
		<textarea id="aes_plaintext" class="module_text">a</textarea><br/>
		<button id="aes_submit" type="submit" class="module_submit">Submit</button>
	</form>
	<div class="module_result">
		<span id="aes_output" class="output"></span><br/>
		<span id="aes_plain_output" class="output"></span>
	</div>
</div>

</body>
</html>
